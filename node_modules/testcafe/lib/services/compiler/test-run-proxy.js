"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const test_run_tracker_1 = __importDefault(require("../../api/test-run-tracker"));
const prerender_callsite_1 = __importDefault(require("../../utils/prerender-callsite"));
const test_controller_1 = __importDefault(require("../../api/test-controller"));
const observed_callsites_storage_1 = __importDefault(require("../../test-run/observed-callsites-storage"));
class TestRunMock {
    constructor(dispatcher, id, fixtureCtx) {
        this.dispatcher = dispatcher;
        this.id = id;
        this.ctx = Object.create(null);
        this.fixtureCtx = fixtureCtx;
        // TODO: Synchronize these properties with their real counterparts in the main process.
        // Postponed until (GH-3244). See details in (GH-5250).
        this.controller = new test_controller_1.default(this);
        this.observedCallsites = new observed_callsites_storage_1.default();
        test_run_tracker_1.default.activeTestRuns[id] = this;
    }
    async executeAction(apiMethodName, command, callsite) {
        if (callsite)
            callsite = prerender_callsite_1.default(callsite);
        return await this.dispatcher.executeAction({ apiMethodName, command, callsite, id: this.id });
    }
}
exports.default = TestRunMock;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC1ydW4tcHJveHkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvc2VydmljZXMvY29tcGlsZXIvdGVzdC1ydW4tcHJveHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxrRkFBd0Q7QUFDeEQsd0ZBQStEO0FBRy9ELGdGQUF1RDtBQUN2RCwyR0FBaUY7QUFHakYsTUFBTSxXQUFXO0lBU2IsWUFBb0IsVUFBcUMsRUFBRSxFQUFVLEVBQUUsVUFBbUI7UUFDdEYsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFFN0IsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUM7UUFFYixJQUFJLENBQUMsR0FBRyxHQUFVLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEMsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFFN0IsdUZBQXVGO1FBQ3ZGLHVEQUF1RDtRQUN2RCxJQUFJLENBQUMsVUFBVSxHQUFVLElBQUkseUJBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxvQ0FBd0IsRUFBRSxDQUFDO1FBRXhELDBCQUFjLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUM3QyxDQUFDO0lBRU0sS0FBSyxDQUFDLGFBQWEsQ0FBRSxhQUFxQixFQUFFLE9BQWdCLEVBQUUsUUFBaUI7UUFDbEYsSUFBSSxRQUFRO1lBQ1IsUUFBUSxHQUFHLDRCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTNDLE9BQU8sTUFBTSxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxFQUFFLGFBQWEsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNsRyxDQUFDO0NBQ0o7QUFFRCxrQkFBZSxXQUFXLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdGVzdFJ1blRyYWNrZXIgZnJvbSAnLi4vLi4vYXBpL3Rlc3QtcnVuLXRyYWNrZXInO1xuaW1wb3J0IHByZXJlbmRlckNhbGxzaXRlIGZyb20gJy4uLy4uL3V0aWxzL3ByZXJlbmRlci1jYWxsc2l0ZSc7XG5cbmltcG9ydCB7IFRlc3RSdW5EaXNwYXRjaGVyUHJvdG9jb2wgfSBmcm9tICcuL3Byb3RvY29sJztcbmltcG9ydCBUZXN0Q29udHJvbGxlciBmcm9tICcuLi8uLi9hcGkvdGVzdC1jb250cm9sbGVyJztcbmltcG9ydCBPYnNlcnZlZENhbGxzaXRlc1N0b3JhZ2UgZnJvbSAnLi4vLi4vdGVzdC1ydW4vb2JzZXJ2ZWQtY2FsbHNpdGVzLXN0b3JhZ2UnO1xuXG5cbmNsYXNzIFRlc3RSdW5Nb2NrIHtcbiAgICBwdWJsaWMgcmVhZG9ubHkgaWQ6IHN0cmluZztcbiAgICBwdWJsaWMgcmVhZG9ubHkgY29udHJvbGxlcjogVGVzdENvbnRyb2xsZXI7XG4gICAgcHVibGljIHJlYWRvbmx5IG9ic2VydmVkQ2FsbHNpdGVzOiBPYnNlcnZlZENhbGxzaXRlc1N0b3JhZ2U7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IGRpc3BhdGNoZXI6IFRlc3RSdW5EaXNwYXRjaGVyUHJvdG9jb2w7XG4gICAgcHJpdmF0ZSByZWFkb25seSBmaXh0dXJlQ3R4OiB1bmtub3duO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgY3R4OiB1bmtub3duO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yIChkaXNwYXRjaGVyOiBUZXN0UnVuRGlzcGF0Y2hlclByb3RvY29sLCBpZDogc3RyaW5nLCBmaXh0dXJlQ3R4OiB1bmtub3duKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlciA9IGRpc3BhdGNoZXI7XG5cbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuXG4gICAgICAgIHRoaXMuY3R4ICAgICAgICA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHRoaXMuZml4dHVyZUN0eCA9IGZpeHR1cmVDdHg7XG5cbiAgICAgICAgLy8gVE9ETzogU3luY2hyb25pemUgdGhlc2UgcHJvcGVydGllcyB3aXRoIHRoZWlyIHJlYWwgY291bnRlcnBhcnRzIGluIHRoZSBtYWluIHByb2Nlc3MuXG4gICAgICAgIC8vIFBvc3Rwb25lZCB1bnRpbCAoR0gtMzI0NCkuIFNlZSBkZXRhaWxzIGluIChHSC01MjUwKS5cbiAgICAgICAgdGhpcy5jb250cm9sbGVyID0gICAgICAgIG5ldyBUZXN0Q29udHJvbGxlcih0aGlzKTtcbiAgICAgICAgdGhpcy5vYnNlcnZlZENhbGxzaXRlcyA9IG5ldyBPYnNlcnZlZENhbGxzaXRlc1N0b3JhZ2UoKTtcblxuICAgICAgICB0ZXN0UnVuVHJhY2tlci5hY3RpdmVUZXN0UnVuc1tpZF0gPSB0aGlzO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBleGVjdXRlQWN0aW9uIChhcGlNZXRob2ROYW1lOiBzdHJpbmcsIGNvbW1hbmQ6IHVua25vd24sIGNhbGxzaXRlOiB1bmtub3duKTogUHJvbWlzZTx1bmtub3duPiB7XG4gICAgICAgIGlmIChjYWxsc2l0ZSlcbiAgICAgICAgICAgIGNhbGxzaXRlID0gcHJlcmVuZGVyQ2FsbHNpdGUoY2FsbHNpdGUpO1xuXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmRpc3BhdGNoZXIuZXhlY3V0ZUFjdGlvbih7IGFwaU1ldGhvZE5hbWUsIGNvbW1hbmQsIGNhbGxzaXRlLCBpZDogdGhpcy5pZCB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFRlc3RSdW5Nb2NrO1xuXG5cbiJdfQ==